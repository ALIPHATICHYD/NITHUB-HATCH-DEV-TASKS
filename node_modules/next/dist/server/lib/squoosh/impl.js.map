{"version":3,"sources":["../../../../src/server/lib/squoosh/impl.ts"],"names":["decodeBuffer","rotate","resize","encodeJpeg","encodeWebp","encodeAvif","encodePng","FIXED_VERSION","DELAY_MS","_promise","delayOnce","ms","Promise","resolve","setTimeout","maybeDelay","isAppleM1","process","arch","platform","semver","lt","version","_buffer","Object","buffer","Buffer","from","firstChunk","slice","firstChunkString","Array","map","v","String","fromCodePoint","join","key","entries","supportedFormats","find","detectors","some","detector","exec","Error","encoder","mod","dec","rgba","decode","Uint8Array","image","numRotations","ImageData","m","preprocessors","instantiate","data","width","height","p","defaultOptions","quality","e","enc","r","encode","defaultEncoderOptions","val","autoOptimize","min","cqLevel","Math","round"],"mappings":"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"}