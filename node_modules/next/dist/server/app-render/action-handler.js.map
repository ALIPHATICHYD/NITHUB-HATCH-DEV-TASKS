{"version":3,"sources":["../../../src/server/app-render/action-handler.ts"],"names":["handleAction","nodeToWebReadableStream","nodeReadable","process","env","NEXT_RUNTIME","Readable","require","toWeb","ReadableStream","start","controller","on","chunk","enqueue","close","error","Error","formDataFromSearchQueryString","query","searchParams","URLSearchParams","formData","FormData","key","value","append","nodeHeadersToRecord","headers","record","Object","entries","undefined","Array","isArray","join","getForwardedHeaders","req","res","requestHeaders","requestCookies","responseHeaders","getHeaders","rawSetCookies","setCookies","map","setCookie","cookie","split","mergedHeaders","filterReqHeaders","mergedCookies","concat","Headers","fetchIPv4v6","url","init","v6","hostname","fetch","catch","err","code","addRevalidationHeader","staticGenerationStore","requestStore","Promise","all","pendingRevalidates","isTagRevalidated","revalidatedTags","length","isCookieRevalidated","getModifiedCookieValues","mutableCookies","setHeader","JSON","stringify","createRedirectRenderResult","redirectUrl","startsWith","forwardedHeaders","set","RSC","host","proto","incrementalCache","requestProtocol","fetchUrl","URL","prerenderManifest","preview","previewModeId","headResponse","method","next","internal","get","RSC_CONTENT_TYPE_HEADER","response","forbiddenHeaders","includes","FlightRenderResult","body","console","RenderResult","ComponentMod","pathname","serverActionsManifest","generateFlight","serverActionsBodySizeLimit","actionId","ACTION","toLowerCase","contentType","isURLEncodedAction","isMultipartAction","isFetchAction","bound","workerName","serverModuleMap","Proxy","_","id","workers","name","chunks","actionAsyncStorage","actionResult","run","isAction","decodeReply","decodeAction","webRequest","request","action","actionData","reader","getReader","done","read","TextDecoder","decode","decodeReplyFromBusboy","busboy","bb","pipe","UndiciRequest","Request","fakeRequest","duplex","parseBody","e","statusCode","message","actionModId","actionHandler","__next_app__","returnVal","apply","resolve","skipFlight","pathWasRevalidated","isRedirectError","getURLFromRedirectError","appendMutableCookies","from","values","isNotFoundError","promise","reject","asNotFound"],"mappings":"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"}