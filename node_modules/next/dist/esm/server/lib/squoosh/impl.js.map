{"version":3,"sources":["../../../../src/server/lib/squoosh/impl.ts"],"names":["semver","codecs","supportedFormats","preprocessors","ImageData","FIXED_VERSION","DELAY_MS","_promise","delayOnce","ms","Promise","resolve","setTimeout","maybeDelay","isAppleM1","process","arch","platform","lt","version","decodeBuffer","_buffer","Object","buffer","Buffer","from","firstChunk","slice","firstChunkString","Array","map","v","String","fromCodePoint","join","key","entries","find","detectors","some","detector","exec","Error","encoder","mod","dec","rgba","decode","Uint8Array","rotate","image","numRotations","m","instantiate","data","width","height","resize","p","defaultOptions","encodeJpeg","quality","e","enc","r","encode","defaultEncoderOptions","encodeWebp","encodeAvif","val","autoOptimize","min","cqLevel","Math","round","encodePng"],"mappings":"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"}