{"version":3,"sources":["../../src/lib/download-wasm-swc.ts"],"names":["downloadWasmSwc","fetch","require","WritableStream","MAX_VERSIONS_TO_CACHE","version","wasmDirectory","variant","pkgName","tarFileName","substring","outputDirectory","path","join","fileExists","cacheDirectory","result","envDefined","process","env","systemCacheDirectory","platform","XDG_CACHE_HOME","os","homedir","LOCALAPPDATA","dir","tmpdir","console","error","Error","exit","isAbsolute","resolve","cwd","fs","promises","mkdir","recursive","extractFromTar","tar","x","file","strip","Log","info","tempFile","Date","now","registry","getRegistry","then","res","ok","body","status","cacheWriteStream","createWriteStream","pipeTo","write","chunk","close","rename","cacheFiles","readdir","length","sort","a","b","localeCompare","i","unlink","catch"],"mappings":"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"}